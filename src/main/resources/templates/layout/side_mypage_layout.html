<!doctype html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org" th:fragment="page(content, title)">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="description" content="Tmoney 교통복지플랫폼"/>
    <meta name="keywords" content="Tmoney 교통복지플랫폼"/>
    <meta property="og:type" content="website"/>
    <meta property="og:title" content="Tmoney 교통복지플랫폼"/>
    <meta property="og:description" content="Tmoney 교통복지플랫폼"/>

    <title th:text="${title} ?: 'Tmoney 교통복지플랫폼'">Tmoney 교통복지플랫폼</title>

    <!-- 공통 CSS -->
    <link rel="stylesheet" th:href="@{/css/vendor/aos.css}"/>
    <link rel="stylesheet" th:href="@{/css/vendor/swiper-bundle.min.css}"/>
    <link rel="stylesheet" th:href="@{/css/index.css}"/>
    <link rel="stylesheet" th:href="@{/css/page/page.css}"/>
</head>

<body>

<!-- 접근성용 skip nav -->
<p id="skip-nav">
    <a href="#contents">본문으로 바로가기</a>
    <a href="#gnb1">주메뉴 바로가기</a>
</p>

<!-- 공통 헤더 -->
<th:block th:replace="~{component/header :: siteHeader}"></th:block>

<!-- 사이드 마이페이지 네비 -->
<th:block th:replace="~{page/side_mypage/mypage-nav :: mypageNav}"></th:block>

<!-- 메인 콘텐츠 -->
<main id="contents" class="container py-4">
    <div th:replace="${contentFragment}"></div>
</main>
<!-- 푸터 & TOP 버튼 -->
<th:block th:replace="~{component/footer_jn :: siteFooterJn}"></th:block>
<th:block th:replace="~{component/topBtn :: siteTop}"></th:block>

<!-- Vendor JS -->
<script th:src="@{/js/vendor/aos.js}"></script>
<script th:src="@{/js/vendor/gsap.min.js}"></script>
<script th:src="@{/js/vendor/ScrollTrigger.min.js}"></script>
<script th:src="@{/js/vendor/swiper-bundle.min.js}"></script>

<!-- 공통 JS -->
<script type="module" th:src="@{/js/common.js}"></script>

<script th:inline="javascript">
    document.addEventListener('DOMContentLoaded', function () {
        if (window.AOS && !window.__aosInited) {
            AOS.init();
            window.__aosInited = true;
        }
    });

    /**
     * 부분 리로드 함수 (목록 갱신 등)
     */
    async function reloadList(url) {
        try {
            const targetUrl = url || window.location.pathname;
            const res = await fetch(targetUrl, { headers: { 'X-Requested-With': 'XMLHttpRequest' } });
            const html = await res.text();
            const doc = new DOMParser().parseFromString(html, 'text/html');
            const newContent = doc.querySelector('#contents > div');
            const currentContent = document.querySelector('#contents > div');
            if (newContent && currentContent) {
                currentContent.replaceWith(newContent);
                if (window.AOS) AOS.refreshHard();
            }
        } catch (err) {
            console.error('[reloadList] 오류:', err);
        }
    }
</script>

</body>
</html>
